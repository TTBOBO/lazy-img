<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="css/style.css" />
	</head>

	<body>
		<ul class="container clearfix">
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>

			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>
			<li><img src="img/picture.png" data-src="http://f12.baidu.com/it/u=455562230,3367033790&fm=76" /></a>
			</li>

		</ul>
		<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
		<script>
			/*
			        1.对于所有的img标签，把真实的地址放入自定义属性data-img
			        2.当滚动页面时，检查页面所有的img标签，看看这个标签是否出现到我们的视野，当出现在我们的视野时
			        再去判断它是否已经加载过，如果没有加载，加载它

			        */

			// 用户第一次打开页面，还未滚动窗口的时候需要执行一次 lazyRender
			lazyRender();

			var clock;
			$(window).on('scroll', function() {
				//用户鼠标滚轮滚动一次，有多次事件响应。下面的 setTimeout 主要是为性能考虑，只在最后一次事件响应的时候执行 lazyRender
				if(clock) {
					clearTimeout(clock)
				}
				clock = setTimeout(function() {
					lazyRender();
				}, 300)

			})

			function lazyRender() {
				$('.container img').each(function() {
					if(checkShow($(this)) && !isLoaded($(this))) {
						loadImg($(this))
					}
				})

			} //判断在没在可视窗口
			function checkShow($img) {
				//滚动的高度
				var scrollTop = $(window).scrollTop();
				//窗口的高度
				var windowHeight = $(window).height();
				//元素到页面顶部的高度
				var offsetTop = $img.offset().top;
				//offsetTop < scrollTop + windowHeight && offsetTop > scrollTop ,这是元素才在我们的可视窗口
				if(offsetTop < scrollTop + windowHeight && offsetTop > scrollTop) {
					return true;
				}
				return false;
			}
			//判断加没加载过
			function isLoaded($img) {
				return $img.attr('data-src') === $img.attr('src')
			}

			function loadImg($img) {
				$img.attr('src', $img.attr('data-src'))
				$img.addClass("img");
			}
		</script>
	</body>

</html>